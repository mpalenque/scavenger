<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,user-scalable=no,maximum-scale=1.0,minimum-scale=1.0" />
  <title>QR Hunt - Find the Pieces</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-57GNRNBXS2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-57GNRNBXS2');
  </script>
  
  <!-- Google Fonts - Poppins para coincidir con Figma -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/index.css">
  <style>
    /* Page-specific tiny overrides only if needed */

    /* no overrides for now */
  </style>
  
  <script>
    (function(){
      try {
        const p = new URLSearchParams(location.search);
        window.__disableCamera = p.get('nocam') === '1';
        window.__lowPower = p.get('low') === '1';
        if (p.get('perf') === '1') localStorage.setItem('perfDebug','1');
        if (window.__lowPower) {
          document.documentElement.classList.add('low-power');
        }
      } catch (e) {}
    })();
  </script>
  
  <script>
    window.addEventListener('load', () => {
      console.log('Html5Qrcode available:', typeof Html5Qrcode !== 'undefined');
      
      if (typeof Html5Qrcode === 'undefined') {
        console.error('‚ùå html5-qrcode failed to load');
      }
    });
  </script>
</head>
<body>
  <div class="camera-container">
    <div id="qr-reader">
      <div id="camera-status">
        <div>üì∑ Camera Initializing...</div>
        <small style="opacity:0.7; margin-top:8px;">Please allow camera access</small>
        <button id="resume-camera-btn" style="display:none; margin-top:10px; padding:8px 16px; background:#00D4D4; color:white; border:none; border-radius:6px; font-size:0.8rem; cursor:pointer;">
          üîÑ Resume Scanning
        </button>
      </div>
    </div>
    
    <!-- Main Instructions - Solo el texto solicitado -->
    <div class="main-instructions">
      <p>Find QR codes to discover the puzzle pieces !</p>
    </div>
    
    <div class="qr-overlay" aria-hidden="true">
      <!-- QR Scanner Frame -->
      <div class="qr-target">
        <!-- Frame is now handled by CSS background -->
      </div>
      
      <div id="scan-flash" class="flash-overlay"></div>
    </div>
    
    <!-- Progress Indicators - EN LA PARTE INFERIOR como en Figma -->
    <div class="progress-container">
      <button class="progress-circle" data-piece="1" data-piece-id="piece_1">?</button>
      <button class="progress-circle" data-piece="2" data-piece-id="piece_2">?</button>
      <button class="progress-circle" data-piece="3" data-piece-id="piece_3">?</button>
      <button class="progress-circle" data-piece="4" data-piece-id="piece_4">?</button>
      <button class="progress-circle" data-piece="5" data-piece-id="piece_5">?</button>
      <button class="progress-circle" data-piece="6" data-piece-id="piece_6">?</button>
      <button class="progress-circle" data-piece="7" data-piece-id="piece_7">?</button>
    </div>
  </div>

  <!-- Test buttons for QR simulation -->
  <div class="test-buttons-container">
    <button class="test-btn" data-test-piece="1" title="Test QR 1">Q1</button>
    <button class="test-btn" data-test-piece="2" title="Test QR 2">Q2</button>
    <button class="test-btn" data-test-piece="3" title="Test QR 3">Q3</button>
    <button class="test-btn" data-test-piece="4" title="Test QR 4">Q4</button>
    <button class="test-btn" data-test-piece="5" title="Test QR 5">Q5</button>
    <button class="test-btn" data-test-piece="6" title="Test QR 6">Q6</button>
    <button class="test-btn" data-test-piece="7" title="Test QR 7">Q7</button>
  </div>

  <div class="ui-overlay">
    <div class="top-bar safe-area-top">
      <!-- Bot√≥n de reset movido a posici√≥n fija arriba a la derecha -->
      <button id="reset-pieces-btn" class="reset-btn">üîÑ Reset</button>
    </div>
        <div class="bottom-panel safe-area-bottom">
      <!-- Hint Display - Centrado -->
      <div class="hint-display" id="hint-display">
  <div id="hint-text">Find QR codes to discover the puzzle pieces !</div>
        <small id="hint-detail" style="opacity: 0.8; display: block; margin-top: 0.25rem;"></small>
      </div>
      
      <!-- Hospital Rooms Button - Peque√±o a la derecha -->
      <div class="hospital-rooms-btn" id="hospital-rooms-btn">
        <div>Rooms</div>
      </div>
    </div>
  </div>

  <div id="qr-reader-results" class="hidden"></div>
  <div id="detected-text" class="hidden"></div>

  <div id="trivia-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <h2 id="trivia-title">üß† Trivia Question</h2>
      <div id="trivia-question">Question will appear here</div>
      <ul id="trivia-options"></ul>
      <div id="trivia-feedback"></div>
      <div style="text-align: center;"><button id="trivia-close" class="btn hidden">Continue</button></div>
    </div>
  </div>

  <div id="final-form" class="modal-overlay hidden">
    <div class="modal-content">
      <h2>Scavenger Hunt Complete!</h2>
      <p>Congratulations, you've finished the AvaSure Symposium Scavenger Hunt! You've unlocked the Vicky Selfie filter. Click the link below to start snapping.</p>
      <p style="margin-top: 1rem;"><a id="selfie-link" href="#" target="_blank" style="color:#35d3d3; font-weight:600; text-decoration:underline;">Open Vicky Selfie Filter</a></p>
      <p style="margin-top: 1rem;">Don't forget to share your selfies in our Symposium LinkedIn group. Also, be sure to enter your name and email for a chance to win a $250 airline gift card!</p>
      <p style="margin-top: 0.5rem;"><a id="linkedin-link" href="#" target="_blank" style="color:#35d3d3; font-weight:600; text-decoration:underline;">Join the LinkedIn Group</a></p>
      <div style="margin-top: 1rem;">
        <input type="text" id="player-name" placeholder="Your name" style="width: 100%; padding: 0.75rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);">
        <input type="email" id="player-email" placeholder="Your email" style="width: 100%; padding: 0.75rem; margin: 0.25rem 0 1rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);">
      </div>
      <div style="text-align: center;"><button id="submit-completion" class="btn">Enter Raffle</button></div>
    </div>
  </div>

  <!-- Intro overlay -->
  <div id="intro-overlay" class="modal-overlay hidden">
    <div class="modal-content" style="max-width: 620px;">
      <h2>Welcome to the AvaSure Symposium AR Scavenger Hunt!</h2>
      <div style="margin-top:1rem; line-height:1.5;">
        <p>Over the next three days, you'll be on the hunt for seven hidden puzzle pieces. The game will guide you to each location, where you‚Äôll solve trivia, attend presentations, or get a demo at our booth. At each stop, you‚Äôll scan QR codes using the camera on your phone to collect your next piece.</p>
        <p style="margin-top:0.75rem;">Once you complete the puzzle, you'll unlock a special AR Vicky selfie filter and be entered into a raffle to win a $250 airline gift card!</p>
        <p style="margin-top:0.75rem;">It‚Äôs a great way to explore everything the symposium has to offer, so jump in, have some fun, and good luck on the hunt!</p>
      </div>
      <div style="text-align:center; margin-top:1.25rem;">
        <button id="intro-start-btn" class="btn" style="border-radius: 30px; padding: 0.8rem 1.4rem; font-weight:700;">Start!</button>
      </div>
    </div>
  </div>

  <!-- html5-qrcode local -->
  <script src="./html5-qrcode.min.js"></script>
  
  <script type="module" src="./js/data.js"></script>
  <script type="module" src="./js/perf.js"></script>
  <script type="module" src="./js/camera.js"></script>
  <script type="module" src="./js/main.js"></script>
</body>
</html>
