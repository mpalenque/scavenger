<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,user-scalable=no,maximum-scale=1.0,minimum-scale=1.0" />
  <title>QR Hunt - Find the Pieces</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-57GNRNBXS2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-57GNRNBXS2');
  </script>
  
  <!-- Google Fonts - Poppins para coincidir con Figma -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { height:100%; background:#000; color:#fff; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; overflow:hidden; }

    /* Disable text selection and focus outlines globally */
    * {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-text-size-adjust: 100%;
      touch-action: manipulation;
    }
    
    /* Prevent zoom on input focus */
    input, button, select, textarea {
      font-size: 16px !important;
      -webkit-appearance: none;
      appearance: none;
    }
    
    *:focus {
      outline: none !important;
    }

    /* Low-power: remove costly blurs */
    .low-power .top-bar, .low-power .bottom-panel, .low-power .btn { 
      -webkit-backdrop-filter:none!important; 
      backdrop-filter:none!important; 
    }

    .camera-container { position:fixed; inset:0; background:#000; z-index:1; }
    #qr-reader { position:absolute; inset:0; width:100%; height:100%; background:#000; }

    #qr-reader video {
      position:absolute !important; 
      inset:0 !important; 
      width:100% !important; 
      height:100% !important;
      object-fit: cover !important; /* Llena toda la pantalla */
      transform:none !important; 
      -webkit-transform:none !important;
      backface-visibility:hidden !important; 
      -webkit-backface-visibility:hidden !important;
      filter:none !important; 
      will-change:auto !important;
    }

    #qr-reader canvas {
      display: none !important;
      visibility: hidden !important;
    }

    /* QR Detection Success Visual Feedback */
    .qr-detected {
      border-color: #4CAF50 !important;
      box-shadow: 0 0 25px rgba(76, 175, 80, 0.6) !important;
      animation: qrSuccess 1s ease-out;
    }
    
    /* QR Already Detected Visual Feedback */
    .qr-already-detected {
      border-color: #FF8A50 !important;
      box-shadow: 0 0 25px rgba(255, 138, 80, 0.6) !important;
      animation: qrAlreadyDetected 1s ease-out;
    }
    
    @keyframes qrSuccess {
      0% { border-color: rgba(45,140,255,0.5); box-shadow: 0 0 18px rgba(45,140,255,0.22); }
      50% { border-color: #4CAF50; box-shadow: 0 0 30px rgba(76, 175, 80, 0.8); }
      100% { border-color: #4CAF50; box-shadow: 0 0 25px rgba(76, 175, 80, 0.6); }
    }
    
    @keyframes qrAlreadyDetected {
      0% { border-color: rgba(45,140,255,0.5); box-shadow: 0 0 18px rgba(45,140,255,0.22); }
      50% { border-color: #FF8A50; box-shadow: 0 0 30px rgba(255, 138, 80, 0.8); }
      100% { border-color: #FF8A50; box-shadow: 0 0 25px rgba(255, 138, 80, 0.6); }
    }

    /* Quiz Answer Feedback Animations */
    .quiz-correct-feedback {
      animation: quizCorrectPulse 1.2s ease-out;
    }
    
    .quiz-incorrect-feedback {
      animation: quizIncorrectPulse 1.2s ease-out;
    }
    
    @keyframes quizCorrectPulse {
      0% { 
        background: rgba(76, 175, 80, 0);
        border-color: rgba(76, 175, 80, 0);
      }
      25% { 
        background: rgba(76, 175, 80, 0.15);
        border-color: rgba(76, 175, 80, 0.8);
        box-shadow: 0 0 30px rgba(76, 175, 80, 0.4);
      }
      50% { 
        background: rgba(76, 175, 80, 0.2);
        border-color: rgba(76, 175, 80, 1);
        box-shadow: 0 0 40px rgba(76, 175, 80, 0.6);
      }
      75% { 
        background: rgba(76, 175, 80, 0.1);
        border-color: rgba(76, 175, 80, 0.6);
        box-shadow: 0 0 25px rgba(76, 175, 80, 0.3);
      }
      100% { 
        background: rgba(76, 175, 80, 0);
        border-color: rgba(76, 175, 80, 0);
        box-shadow: none;
      }
    }
    
    @keyframes quizIncorrectPulse {
      0% { 
        background: rgba(244, 67, 54, 0);
        border-color: rgba(244, 67, 54, 0);
      }
      25% { 
        background: rgba(244, 67, 54, 0.15);
        border-color: rgba(244, 67, 54, 0.8);
        box-shadow: 0 0 30px rgba(244, 67, 54, 0.4);
      }
      50% { 
        background: rgba(244, 67, 54, 0.2);
        border-color: rgba(244, 67, 54, 1);
        box-shadow: 0 0 40px rgba(244, 67, 54, 0.6);
      }
      75% { 
        background: rgba(244, 67, 54, 0.1);
        border-color: rgba(244, 67, 54, 0.6);
        box-shadow: 0 0 25px rgba(244, 67, 54, 0.3);
      }
      100% { 
        background: rgba(244, 67, 54, 0);
        border-color: rgba(244, 67, 54, 0);
        box-shadow: none;
      }
    }

    .ui-overlay { 
      position:fixed; 
      inset:0; 
      z-index:10; 
      pointer-events:none; 
      display:flex; 
      flex-direction:column; 
    }
    .ui-overlay > * { pointer-events:auto; }

    .top-bar { 
      background: transparent; /* Sin máscara oscura */
      padding: calc(env(safe-area-inset-top) + 0.5rem) 1rem 0.75rem 1rem; 
      /* Sin backdrop-filter */
    }
    /* Remove unused styles */
    .reset-btn {
      background: rgba(255, 71, 87, 0.9); /* Más opaco sin máscara de fondo */
      border: 2px solid rgba(255, 71, 87, 0.8);
      color: white;
      border-radius: 8px;
      padding: 0.5rem 1rem;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-shadow: 0 1px 2px rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      position: fixed;
      top: calc(env(safe-area-inset-top) + 14px);
      right: 14px;
      z-index: 16;
    }
    .reset-btn:hover {
      background: rgba(255, 71, 87, 1);
      transform: translateY(-1px);
    }
    .reset-btn:active {
      transform: translateY(0);
    }
    
    /* Remove unused responsive styles */

    .qr-overlay { 
      position:absolute; 
      inset:0; 
      z-index:5; 
      display:flex; 
      flex-direction: column;
      align-items:center; 
      justify-content:center; 
      pointer-events:none; 
      gap: 2rem;
    }
    
    /* Allow pointer events on interactive elements */
    .qr-overlay .progress-container {
      pointer-events: auto;
    }
    
    .qr-overlay .progress-circle {
      pointer-events: auto;
    }
    
    .qr-overlay .hint-display {
      pointer-events: auto;
    }
    
    /* Main Instructions Container - Figma style - ARRIBA */
    .main-instructions {
      background: rgba(22, 37, 46, 0.9);
      border: 3px solid #00D4D4;
      border-radius: 40px;
      padding: 1.5rem 2rem;
      text-align: center;
      max-width: 300px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      position: absolute;
      top: 60px; /* Posicionado arriba */
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
    }
    
    .main-instructions h2 {
      color: white;
      font-size: 1rem;
      font-weight: 600;
      margin: 0;
      line-height: 1.3;
    }
    
    .main-instructions p {
      color: rgba(255, 255, 255, 0.8);
      font-size: 0.8rem;
      margin: 0.25rem 0 0 0;
    }
    
    .qr-target { 
      width: 280px;
      height: 280px;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: url('./assets/c_scan_QR_code.svg') center/contain no-repeat;
      pointer-events: none;
      z-index: 10;
      transition: all 0.3s ease;
    }
    
    /* QR detection success state - change to green SVG */
    .qr-target.qr-detected {
      background-image: url('./assets/c_scan_QR_code_green.svg');
      transform: translate(-50%, -50%) scale(1.05);
    }
    
    /* Remove old corner styles - not needed with SVG */
    .qr-target::before, .qr-target::after { 
      display: none;
    }
    .qr-corner { 
      display: none;
    }
    
    /* Scan instruction text - Figma exact match */
    .scan-instruction {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 80px; /* Below the frame */
      font-family: 'Poppins', sans-serif;
      font-weight: 800; /* ExtraBold */
      font-size: 14px;
      text-transform: uppercase;
      color: #35d3d3;
      text-align: center;
      width: 113px;
      line-height: 1.4;
      z-index: 10;
      pointer-events: none;
    }
    /* Remove old corner styles */

    .flash-overlay { 
      position:absolute; 
      inset:0; 
      background: transparent; 
      opacity:0; 
      pointer-events:none; 
      z-index:20; 
      display: none;
    }
    .flash-animate { animation: flashPulse 380ms ease-out; }
    @keyframes flashPulse { 
      0% { opacity:0; } 
      15% { opacity:0.9; } 
      100% { opacity:0; } 
    }

    .bottom-panel { 
      margin-top:auto; 
      background: transparent; /* Sin máscara oscura */
      padding:0.75rem; 
      padding-bottom: calc(0.75rem + env(safe-area-inset-bottom)); 
      /* Sin backdrop-filter */
      max-height:35vh; 
      overflow-y:auto; 
    }
    
    /* Progress indicators - Posicionados ABAJO según Figma */
    .progress-container {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      position: absolute;
      bottom: 150px; /* Subido 10px más arriba del hint display */
      left: 50%;
      transform: translateX(-50%);
      z-index: 15;
      padding: 0 1rem;
    }
    
    .progress-circle {
      width: 32px;
      height: 32px;
      background: url('./assets/empty-circle.svg') center/contain no-repeat;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      padding: 0;
      margin: 0;
      outline: none !important; /* Sin outline rectangular */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      pointer-events: auto;
      position: relative;
      border-radius: 50%; /* Asegurar que sea circular */
      -webkit-appearance: none; /* Remover estilos nativos */
      -moz-appearance: none;
      appearance: none;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #35d3d3;
      font-family: 'Poppins', sans-serif;
      font-weight: bold;
      font-size: 16px;
    }
    
    /* Remover focus outline rectangular */
    .progress-circle:focus {
      outline: none !important;
      box-shadow: 0 0 0 2px #00D4D4; /* Solo sombra circular */
    }
    
    .progress-circle:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0, 212, 212, 0.3);
    }
    
    .progress-circle:active {
      transform: scale(0.95);
    }
    
    .progress-circle.completed {
      background: url('./assets/check-circle.svg') center/contain no-repeat;
      color: transparent; /* Ocultar el "?" cuando está completado */
    }
    
    .progress-circle.selected {
      box-shadow: 0 0 0 3px #00D4D4, 0 4px 12px rgba(0, 212, 212, 0.4);
      transform: scale(1.05);
    }
    
    .progress-circle.selected::after {
      content: '';
      position: absolute;
      inset: -6px; /* Más espacio para el círculo */
      border: 3px solid #00D4D4;
      border-radius: 50%; /* CÍRCULO perfecto */
      animation: pulse-ring 2s infinite;
      opacity: 0.6;
      pointer-events: none; /* No interferir con clicks */
    }
    
    @keyframes pulse-ring {
      0% { 
        transform: scale(0.8); 
        opacity: 0.8; 
      }
      100% { 
        transform: scale(1.3); 
        opacity: 0; 
      }
    }
    
    /* Hint display - fijo, tamaño constante */
    .hint-display {
      background: linear-gradient(135deg, #FF8A50, #FF6B2C);
      border: 2px solid #FF6B2C;
      color: white;
      padding: 1.1rem 1.4rem; /* Ajuste para mantener contenido visible dentro de altura fija */
      border-radius: 50px;
      text-align: center;
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: min(90vw, 360px);
      height: 96px; /* Altura fija */
      box-shadow: 0 4px 12px rgba(255, 107, 44, 0.3);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 14;
      overflow: hidden; /* Evitar crecimiento por contenido */
    }
    
    /* Hospital Rooms button - mover arriba a la izquierda para no pisar la pista */
    .hospital-rooms-btn {
      background: linear-gradient(135deg, #35D3D3, #20B2B2);
      border: 2px solid #20B2B2;
      color: white;
      padding: 8px 16px;
      border-radius: 25px;
      text-align: center;
      position: fixed;
      top: calc(env(safe-area-inset-top) + 14px);
      left: 14px;
      bottom: auto;
      right: auto;
      width: 120px; /* Pequeño */
      min-height: 40px; /* Bajo */
      box-shadow: 0 4px 12px rgba(53, 211, 211, 0.3);
      transition: all 0.3s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 16; /* Por encima del hint */
      cursor: pointer;
      font-size: 0.8rem; /* Texto más pequeño */
      font-weight: 600;
    }
    
    .hospital-rooms-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(53, 211, 211, 0.4);
    }
    
    .hospital-rooms-btn:active {
      transform: translateY(0px);
    }
    
    #hint-text {
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0;
      color: white;
      display: -webkit-box; /* Clamp para múltiples líneas */
      line-clamp: 2;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }
    
    #hint-detail {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 0.35rem;
      color: white;
      display: -webkit-box;
      line-clamp: 1;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }
    
    /* Remove dynamic hint colors - always white */
    /* Remove unused clue styles */

    /* Button styles */
    .btn {
      background: rgba(45, 140, 255, 0.9);
      color: white;
      border: none;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(45, 140, 255, 0.3);
      transition: all 0.2s ease;
    }

    .btn:hover, .btn:active {
      background: rgba(45, 140, 255, 1);
      transform: translateY(-1px);
    }

    /* Hidden elements */
    .hidden {
      display: none !important;
    }

    /* Camera status - Texto más pequeño para caber en el frame */
    #camera-status {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #35d3d3;
      font-weight: 600;
      font-size: 0.75rem; /* Mitad del tamaño original */
      z-index: 3;
      background: rgba(0,0,0,0.8);
      padding: 0.75rem 1rem;
      border-radius: 8px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      white-space: nowrap;
      max-width: 200px; /* Para que no exceda el frame */
      line-height: 1.2;
    }

    /* Hide html5-qrcode overlays completely */
    .qr-shaded-region, 
    #qr-reader__scan_region, 
    #qr-reader div[style*="border"] { 
      display:none !important; 
      visibility:hidden !important; 
    }

    /* iOS fix */
    @supports (-webkit-touch-callout: none) {
      .top-bar, .bottom-panel { 
        -webkit-backdrop-filter: none !important; 
        backdrop-filter: none !important; 
      }
      #qr-reader * { 
        -webkit-transform:none !important; 
        transform:none !important; 
      }
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 1rem;
    }

    .modal-content {
      background: rgba(26, 31, 46, 0.95);
      padding: 2rem;
      border-radius: 16px;
      max-width: 90vw;
      width: 400px;
      max-height: 90vh;
      overflow-y: auto;
      border: 2px solid rgba(45, 140, 255, 0.3);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    /* Trivia styles - Diseño Figma p_trivia */
    #trivia-modal .modal-content {
      background: #16252e; /* Fondo oscuro como Figma */
      border: none;
      max-width: 400px;
      width: 90%;
      padding: 2rem;
    }

    #trivia-title {
      display: none; /* Ocultamos el título emoji */
    }

    #trivia-question {
      background: #ff9243; /* Naranja como en Figma */
      color: white;
      padding: 1.5rem 2rem;
      border-radius: 58.5px; /* Redondeado como Figma */
      text-align: center;
      font-weight: bold;
      font-size: 1.5rem;
      line-height: 1.1;
      margin: 0 0 2rem 0;
      font-family: 'Poppins', sans-serif;
    }

    #trivia-options li {
      margin: 1rem 0;
    }

    #trivia-options button {
      width: 100%;
      padding: 1.5rem 2rem;
      background: #143940; /* Fondo oscuro no seleccionado */
      color: white;
      border: 4px solid #35d3d3; /* Borde cian */
      border-radius: 58.5px; /* Redondeado como Figma */
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      font-family: 'Poppins', sans-serif;
      text-align: center;
    }

    #trivia-options button:hover, #trivia-options button:active {
      background: #35d3d3; /* Fondo cian al seleccionar */
      border-color: #35d3d3;
      transform: translateY(-2px);
    }

    #trivia-options button:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    #trivia-options button.correct {
      background: #35d3d3 !important; /* Cian para respuesta correcta */
      border-color: #35d3d3 !important;
    }

    #trivia-options button.incorrect {
      background: #143940 !important; /* Mantener oscuro para incorrecta */
      border-color: #f44336 !important; /* Borde rojo para incorrecta */
    }

    #trivia-feedback {
      color: white;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
    }

    #trivia-close {
      background: #35d3d3;
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 30px;
      font-weight: 600;
      font-family: 'Poppins', sans-serif;
    }

    /* Test buttons for QR simulation */
  .test-buttons-container {
      position: fixed;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      z-index: 20;
  display: flex; /* Visible for simulation */
      flex-direction: column;
      gap: 8px;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 212, 212, 0.3);
    }

    .test-btn {
      width: 40px;
      height: 40px;
      background: rgba(0, 212, 212, 0.8);
      border: 2px solid rgba(0, 212, 212, 0.6);
      border-radius: 8px;
      color: white;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      outline: none;
    }

    .test-btn:hover {
      background: rgba(0, 212, 212, 1);
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(0, 212, 212, 0.5);
    }

    .test-btn:active {
      transform: scale(0.95);
    }

    .test-btn.completed {
      background: rgba(76, 175, 80, 0.8);
      border-color: rgba(76, 175, 80, 0.6);
    }

    .test-btn.completed:hover {
      background: rgba(76, 175, 80, 1);
      box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
    }

    /* Hide test buttons on small screens to avoid overlap */
    @media (max-width: 480px) {
      .test-buttons-container {
        display: none !important; /* Force hidden on mobile */
        left: 5px;
        gap: 6px;
        padding: 8px;
      }
      
      .test-btn {
        width: 35px;
        height: 35px;
        font-size: 11px;
      }
    }
  </style>
  
  <script>
    (function(){
      try {
        const p = new URLSearchParams(location.search);
        window.__disableCamera = p.get('nocam') === '1';
        window.__lowPower = p.get('low') === '1';
        if (p.get('perf') === '1') localStorage.setItem('perfDebug','1');
        if (window.__lowPower) {
          document.documentElement.classList.add('low-power');
        }
      } catch (e) {}
    })();
  </script>
  
  <script>
    window.addEventListener('load', () => {
      console.log('Html5Qrcode available:', typeof Html5Qrcode !== 'undefined');
      
      if (typeof Html5Qrcode === 'undefined') {
        console.error('❌ html5-qrcode failed to load');
      }
    });
  </script>
</head>
<body>
  <div class="camera-container">
    <div id="qr-reader">
      <div id="camera-status">
        <div>📷 Camera Initializing...</div>
        <small style="opacity:0.7; margin-top:8px;">Please allow camera access</small>
        <button id="resume-camera-btn" style="display:none; margin-top:10px; padding:8px 16px; background:#00D4D4; color:white; border:none; border-radius:6px; font-size:0.8rem; cursor:pointer;">
          🔄 Resume Scanning
        </button>
      </div>
    </div>
    
    <!-- Main Instructions - Solo el texto solicitado -->
    <div class="main-instructions">
      <p>Find QR codes to discover the puzzle pieces !</p>
    </div>
    
    <div class="qr-overlay" aria-hidden="true">
      <!-- QR Scanner Frame -->
      <div class="qr-target">
        <!-- Frame is now handled by CSS background -->
      </div>
      
      <div id="scan-flash" class="flash-overlay"></div>
    </div>
    
    <!-- Progress Indicators - EN LA PARTE INFERIOR como en Figma -->
    <div class="progress-container">
      <button class="progress-circle" data-piece="1" data-piece-id="piece_1">?</button>
      <button class="progress-circle" data-piece="2" data-piece-id="piece_2">?</button>
      <button class="progress-circle" data-piece="3" data-piece-id="piece_3">?</button>
      <button class="progress-circle" data-piece="4" data-piece-id="piece_4">?</button>
      <button class="progress-circle" data-piece="5" data-piece-id="piece_5">?</button>
      <button class="progress-circle" data-piece="6" data-piece-id="piece_6">?</button>
      <button class="progress-circle" data-piece="7" data-piece-id="piece_7">?</button>
    </div>
  </div>

  <!-- Test buttons for QR simulation -->
  <div class="test-buttons-container">
    <button class="test-btn" data-test-piece="1" title="Test QR 1">Q1</button>
    <button class="test-btn" data-test-piece="2" title="Test QR 2">Q2</button>
    <button class="test-btn" data-test-piece="3" title="Test QR 3">Q3</button>
    <button class="test-btn" data-test-piece="4" title="Test QR 4">Q4</button>
    <button class="test-btn" data-test-piece="5" title="Test QR 5">Q5</button>
    <button class="test-btn" data-test-piece="6" title="Test QR 6">Q6</button>
    <button class="test-btn" data-test-piece="7" title="Test QR 7">Q7</button>
  </div>

  <div class="ui-overlay">
    <div class="top-bar safe-area-top">
      <!-- Botón de reset movido a posición fija arriba a la derecha -->
      <button id="reset-pieces-btn" class="reset-btn">🔄 Reset</button>
    </div>
        <div class="bottom-panel safe-area-bottom">
      <!-- Hint Display - Centrado -->
      <div class="hint-display" id="hint-display">
  <div id="hint-text">Find QR codes to discover the puzzle pieces !</div>
        <small id="hint-detail" style="opacity: 0.8; display: block; margin-top: 0.25rem;"></small>
      </div>
      
      <!-- Hospital Rooms Button - Pequeño a la derecha -->
      <div class="hospital-rooms-btn" id="hospital-rooms-btn">
        <div>Rooms</div>
      </div>
    </div>
  </div>

  <div id="qr-reader-results" class="hidden"></div>
  <div id="detected-text" class="hidden"></div>

  <div id="trivia-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <h2 id="trivia-title">🧠 Trivia Question</h2>
      <div id="trivia-question">Question will appear here</div>
      <ul id="trivia-options"></ul>
      <div id="trivia-feedback"></div>
      <div style="text-align: center;"><button id="trivia-close" class="btn hidden">Continue</button></div>
    </div>
  </div>

  <div id="final-form" class="modal-overlay hidden">
    <div class="modal-content">
      <h2>Scavenger Hunt Complete!</h2>
      <p>Congratulations, you've finished the AvaSure Symposium Scavenger Hunt! You've unlocked the Vicky Selfie filter. Click the link below to start snapping.</p>
      <p style="margin-top: 1rem;"><a id="selfie-link" href="#" target="_blank" style="color:#35d3d3; font-weight:600; text-decoration:underline;">Open Vicky Selfie Filter</a></p>
      <p style="margin-top: 1rem;">Don't forget to share your selfies in our Symposium LinkedIn group. Also, be sure to enter your name and email for a chance to win a $250 airline gift card!</p>
      <p style="margin-top: 0.5rem;"><a id="linkedin-link" href="#" target="_blank" style="color:#35d3d3; font-weight:600; text-decoration:underline;">Join the LinkedIn Group</a></p>
      <div style="margin-top: 1rem;">
        <input type="text" id="player-name" placeholder="Your name" style="width: 100%; padding: 0.75rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);">
        <input type="email" id="player-email" placeholder="Your email" style="width: 100%; padding: 0.75rem; margin: 0.25rem 0 1rem; border-radius: 8px; border: 1px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);">
      </div>
      <div style="text-align: center;"><button id="submit-completion" class="btn">Enter Raffle</button></div>
    </div>
  </div>

  <!-- Intro overlay -->
  <div id="intro-overlay" class="modal-overlay hidden">
    <div class="modal-content" style="max-width: 620px;">
      <h2>Welcome to the AvaSure Symposium AR Scavenger Hunt!</h2>
      <div style="margin-top:1rem; line-height:1.5;">
        <p>Over the next three days, you'll be on the hunt for seven hidden puzzle pieces. The game will guide you to each location, where you’ll solve trivia, attend presentations, or get a demo at our booth. At each stop, you’ll scan QR codes using the camera on your phone to collect your next piece.</p>
        <p style="margin-top:0.75rem;">Once you complete the puzzle, you'll unlock a special AR Vicky selfie filter and be entered into a raffle to win a $250 airline gift card!</p>
        <p style="margin-top:0.75rem;">It’s a great way to explore everything the symposium has to offer, so jump in, have some fun, and good luck on the hunt!</p>
      </div>
      <div style="text-align:center; margin-top:1.25rem;">
        <button id="intro-start-btn" class="btn" style="border-radius: 30px; padding: 0.8rem 1.4rem; font-weight:700;">Start!</button>
      </div>
    </div>
  </div>

  <!-- html5-qrcode local -->
  <script src="./html5-qrcode.min.js"></script>
  
  <script type="module" src="./js/data.js"></script>
  <script type="module" src="./js/perf.js"></script>
  <script type="module" src="./js/camera.js"></script>
  <script type="module" src="./js/main.js"></script>
</body>
</html>
